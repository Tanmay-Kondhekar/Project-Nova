================================================================================
ML-BASED VULNERABILITY DETECTION REPORT
================================================================================
Generated: 2026-02-13 14:45:27
Model: GraphCodeBERT + Multi-Relational GNN
Total Functions Analyzed: 8
Vulnerable Functions: 8
================================================================================

VULNERABLE FUNCTIONS (Sorted by Confidence):
--------------------------------------------------------------------------------[1] VULNERABLE (Confidence: 69.52%)
File:     testing.cpp
Function: authenticate
Code:
----------------------------------------
bool authenticate(char *user_input) {
    char password[16];
    strcpy(password, user_input); // CWE-120: buffer overflow
    return strcmp(password, "admin") == 0;
}
----------------------------------------


[2] VULNERABLE (Confidence: 68.29%)
File:     testing.cpp
Function: increment_counter
Code:
----------------------------------------
void increment_counter() {
    for (int i = 0; i < 1000; i++) {
        shared_counter++; // CWE-362: race condition
    }
}
----------------------------------------


[3] VULNERABLE (Confidence: 68.21%)
File:     testing.cpp
Function: write_to_buffer
Code:
----------------------------------------
void write_to_buffer(char *buf, int index, char value) {
    buf[index] = value; // CWE-787: out-of-bounds write
}
----------------------------------------


[4] VULNERABLE (Confidence: 67.91%)
File:     testing.cpp
Function: allocate_data
Code:
----------------------------------------
char* allocate_data(int size) {
    if (size * 2 < size) { // CWE-190: integer overflow
        return nullptr;
    }

    char *data = (char*)malloc(size);
    if (!data) return nullptr;

    strcpy(data, "DEFAULT"); // CWE-121 if size < 8
    return data;
}
----------------------------------------


[5] VULNERABLE (Confidence: 67.67%)
File:     testing.cpp
Function: process_request
Code:
----------------------------------------
void process_request(char *input) {
    char buffer[32];
    strcpy(buffer, input); // CWE-120
    unsafe_log(buffer);    // CWE-134
}
----------------------------------------


[6] VULNERABLE (Confidence: 66.85%)
File:     testing.cpp
Function: main
Code:
----------------------------------------
int main(int argc, char *argv[]) {

    if (argc < 2) {
        cout << "Usage: ./vulnerable_system <input>" << endl;
        return 1;
    }

    // AUTH
    if (!authenticate(argv[1])) {
        cout << "Authentication failed" << endl;
    }

    // MEMORY ALLOCATION
    char *data = allocate_data(4);
    if (data == nullptr) {
        cout << "Allocation failed" << endl;
        return 1;
    }

    // USE AFTER FREE
    free(data);
    cout << data << endl; // CWE-416: use-after-free

    //...
----------------------------------------


[7] VULNERABLE (Confidence: 66.02%)
File:     testing.cpp
Function: free_data
Code:
----------------------------------------
void free_data(char *data) {
    free(data);
    free(data); // CWE-415: double free
}
----------------------------------------


[8] VULNERABLE (Confidence: 64.00%)
File:     testing.cpp
Function: unsafe_log
Code:
----------------------------------------
void unsafe_log(const char *msg) {
    printf(msg); // CWE-134: format string vulnerability
}
----------------------------------------



================================================================================
NOTE: This is ML-based detection. The model learned patterns from BigVul.
Always verify findings manually and consider code context.
================================================================================
